/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
!function(){function e(e){var t=e.getStyle("overflow-y"),i=e.getDocument(),n=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",i);i[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(n);var a=n.getDocumentPosition(i).y+n.$.offsetHeight;return n.remove(),e.setStyle("overflow-y",t),a}var t=function(t){if(t.window){var i=t.document,n=(new CKEDITOR.dom.element(i.getWindow().$.frameElement),i.getBody()),a=i.getDocumentElement(),o=t.window.getViewPaneSize().height,r="BackCompat"==i.$.compatMode?n:a,s=e(r);s+=t.config.autoGrow_bottomSpace||0;var l=void 0!=t.config.autoGrow_minHeight?t.config.autoGrow_minHeight:200,d=t.config.autoGrow_maxHeight||1/0;s=Math.max(s,l),s=Math.min(s,d),s!=o&&(s=t.fire("autoGrow",{currentHeight:o,newHeight:s}).newHeight,t.resize(t.container.getStyle("width"),s,!0)),r.$.scrollHeight>r.$.clientHeight&&d>s?r.setStyle("overflow-y","hidden"):r.removeStyle("overflow-y")}};CKEDITOR.plugins.add("autogrow",{init:function(e){e.addCommand("autogrow",{exec:t,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var i={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};e.config.autoGrow_onStartup&&(i.instanceReady=1);for(var n in i)e.on(n,function(i){var n=e.getCommand("maximize");"wysiwyg"!=i.editor.mode||n&&n.state==CKEDITOR.TRISTATE_ON||setTimeout(function(){t(i.editor),t(i.editor)},100)})}})}();